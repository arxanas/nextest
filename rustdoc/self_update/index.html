<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Build status Build Status crates.io:clin docs"><meta name="keywords" content="rust, rustlang, rust-lang, self_update"><title>self_update - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../self_update/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../self_update/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate self_update</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.30.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../self_update/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">self_update</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/self_update/lib.rs.html#1-1093">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><a href="https://ci.appveyor.com/project/jaemk/self-update/branch/master"><img src="https://ci.appveyor.com/api/projects/status/xlkq8rd73cla4ixw/branch/master?svg=true" alt="Build status" /></a>
<a href="https://travis-ci.org/jaemk/self_update"><img src="https://travis-ci.org/jaemk/self_update.svg?branch=master" alt="Build Status" /></a>
<a href="https://crates.io/crates/self_update"><img src="https://img.shields.io/crates/v/self_update.svg?label=self_update" alt="crates.io:clin" /></a>
<a href="https://docs.rs/self_update"><img src="https://docs.rs/self_update/badge.svg" alt="docs" /></a></p>
<p><code>self_update</code> provides updaters for updating rust executables in-place from various release
distribution backends.</p>
<h3 id="usage"><a href="#usage">Usage</a></h3>
<p>Update (replace) the current executable with the latest release downloaded
from <code>https://api.github.com/repos/jaemk/self_update/releases/latest</code>.
Note, the <a href="https://github.com/japaric/trust"><code>trust</code></a> project provides a nice setup for
producing release-builds via CI (travis/appveyor).</p>
<h4 id="features"><a href="#features">Features</a></h4>
<p>The following <a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-features-section">cargo features</a> are
available (but <em>disabled</em> by default):</p>
<ul>
<li><code>archive-tar</code>: Support for <em>tar</em> archive format;</li>
<li><code>archive-zip</code>: Support for <em>zip</em> archive format;</li>
<li><code>compression-flate2</code>: Support for <em>gzip</em> compression;</li>
<li><code>compression-zip-deflate</code>: Support for <em>zip</em>’s <em>deflate</em> compression format;</li>
<li><code>compression-zip-bzip2</code>: Support for <em>zip</em>’s <em>bzip2</em> compression format;</li>
<li><code>rustls</code>: Use <a href="https://github.com/ctz/rustls">pure rust TLS implementation</a> for network requests. This feature does <em>not</em> support 32bit macOS;</li>
</ul>
<p>Please activate the feature(s) needed by your release files.</p>
<h4 id="example"><a href="#example">Example</a></h4>
<p>Run the following example to see <code>self_update</code> in action:</p>
<p><code>cargo run --example github --features &quot;archive-tar archive-zip compression-flate2 compression-zip-deflate&quot;</code>.</p>
<p>There’s also an equivalent example for gitlab:</p>
<p><code>cargo run --example gitlab --features &quot;archive-tar archive-zip compression-flate2 compression-zip-deflate&quot;</code>.</p>
<p>which runs something roughly equivalent to:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">self_update::cargo_crate_version</span>;

<span class="kw">fn</span> <span class="ident">update</span>() -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Box</span><span class="op">&lt;</span><span class="ident">::std::error::Error</span><span class="op">&gt;</span><span class="op">&gt;</span> {
    <span class="kw">let</span> <span class="ident">status</span> <span class="op">=</span> <span class="ident">self_update::backends::github::Update::configure</span>()
        .<span class="ident">repo_owner</span>(<span class="string">&quot;jaemk&quot;</span>)
        .<span class="ident">repo_name</span>(<span class="string">&quot;self_update&quot;</span>)
        .<span class="ident">bin_name</span>(<span class="string">&quot;github&quot;</span>)
        .<span class="ident">show_download_progress</span>(<span class="bool-val">true</span>)
        .<span class="ident">current_version</span>(<span class="macro">cargo_crate_version!</span>())
        .<span class="ident">build</span>()<span class="question-mark">?</span>
        .<span class="ident">update</span>()<span class="question-mark">?</span>;
    <span class="macro">println!</span>(<span class="string">&quot;Update status: `{}`!&quot;</span>, <span class="ident">status</span>.<span class="ident">version</span>());
    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<p>Amazon S3, Google GCS, and DigitalOcean Spaces are also supported through the <code>S3</code> backend to check for new releases. Provided a <code>bucket_name</code>
and <code>asset_prefix</code> string, <code>self_update</code> will look up all matching files using the following format
as a convention for the filenames: <code>[directory/]&lt;asset name&gt;-&lt;semver&gt;-&lt;platform/target&gt;.&lt;extension&gt;</code>.
Leading directories will be stripped from the file name allowing the use of subdirectories in the S3 bucket,
and any file not matching the format, or not matching the provided prefix string, will be ignored.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">self_update::cargo_crate_version</span>;

<span class="kw">fn</span> <span class="ident">update</span>() -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Box</span><span class="op">&lt;</span><span class="ident">::std::error::Error</span><span class="op">&gt;</span><span class="op">&gt;</span> {
    <span class="kw">let</span> <span class="ident">status</span> <span class="op">=</span> <span class="ident">self_update::backends::s3::Update::configure</span>()
        .<span class="ident">bucket_name</span>(<span class="string">&quot;self_update_releases&quot;</span>)
        .<span class="ident">asset_prefix</span>(<span class="string">&quot;something/self_update&quot;</span>)
        .<span class="ident">region</span>(<span class="string">&quot;eu-west-2&quot;</span>)
        .<span class="ident">bin_name</span>(<span class="string">&quot;self_update_example&quot;</span>)
        .<span class="ident">show_download_progress</span>(<span class="bool-val">true</span>)
        .<span class="ident">current_version</span>(<span class="macro">cargo_crate_version!</span>())
        .<span class="ident">build</span>()<span class="question-mark">?</span>
        .<span class="ident">update</span>()<span class="question-mark">?</span>;
    <span class="macro">println!</span>(<span class="string">&quot;S3 Update status: `{}`!&quot;</span>, <span class="ident">status</span>.<span class="ident">version</span>());
    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<p>Separate utilities are also exposed (<strong>NOTE</strong>: the following example <em>requires</em> the <code>archive-tar</code> feature,
see the <a href="#features">features</a> section above):</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">fn</span> <span class="ident">update</span>() -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Box</span><span class="op">&lt;</span><span class="ident">::std::error::Error</span><span class="op">&gt;</span><span class="op">&gt;</span> {
    <span class="kw">let</span> <span class="ident">releases</span> <span class="op">=</span> <span class="ident">self_update::backends::github::ReleaseList::configure</span>()
        .<span class="ident">repo_owner</span>(<span class="string">&quot;jaemk&quot;</span>)
        .<span class="ident">repo_name</span>(<span class="string">&quot;self_update&quot;</span>)
        .<span class="ident">build</span>()<span class="question-mark">?</span>
        .<span class="ident">fetch</span>()<span class="question-mark">?</span>;
    <span class="macro">println!</span>(<span class="string">&quot;found releases:&quot;</span>);
    <span class="macro">println!</span>(<span class="string">&quot;{:#?}\n&quot;</span>, <span class="ident">releases</span>);

    <span class="comment">// get the first available release</span>
    <span class="kw">let</span> <span class="ident">asset</span> <span class="op">=</span> <span class="ident">releases</span>[<span class="number">0</span>]
        .<span class="ident">asset_for</span>(<span class="kw-2">&amp;</span><span class="ident">self_update::get_target</span>()).<span class="ident">unwrap</span>();

    <span class="kw">let</span> <span class="ident">tmp_dir</span> <span class="op">=</span> <span class="ident">tempfile::Builder::new</span>()
            .<span class="ident">prefix</span>(<span class="string">&quot;self_update&quot;</span>)
            .<span class="ident">tempdir_in</span>(<span class="ident">::std::env::current_dir</span>()<span class="question-mark">?</span>)<span class="question-mark">?</span>;
    <span class="kw">let</span> <span class="ident">tmp_tarball_path</span> <span class="op">=</span> <span class="ident">tmp_dir</span>.<span class="ident">path</span>().<span class="ident">join</span>(<span class="kw-2">&amp;</span><span class="ident">asset</span>.<span class="ident">name</span>);
    <span class="kw">let</span> <span class="ident">tmp_tarball</span> <span class="op">=</span> <span class="ident">::std::fs::File::open</span>(<span class="kw-2">&amp;</span><span class="ident">tmp_tarball_path</span>)<span class="question-mark">?</span>;

    <span class="ident">self_update::Download::from_url</span>(<span class="kw-2">&amp;</span><span class="ident">asset</span>.<span class="ident">download_url</span>)
        .<span class="ident">set_header</span>(<span class="ident">reqwest::header::ACCEPT</span>, <span class="string">&quot;application/octet-stream&quot;</span>.<span class="ident">parse</span>()<span class="question-mark">?</span>)
        .<span class="ident">download_to</span>(<span class="kw-2">&amp;</span><span class="ident">tmp_tarball</span>)<span class="question-mark">?</span>;

    <span class="kw">let</span> <span class="ident">bin_name</span> <span class="op">=</span> <span class="ident">std::path::PathBuf::from</span>(<span class="string">&quot;self_update_bin&quot;</span>);
    <span class="ident">self_update::Extract::from_source</span>(<span class="kw-2">&amp;</span><span class="ident">tmp_tarball_path</span>)
        .<span class="ident">archive</span>(<span class="ident">self_update::ArchiveKind::Tar</span>(<span class="prelude-val">Some</span>(<span class="ident">self_update::Compression::Gz</span>)))
        .<span class="ident">extract_file</span>(<span class="kw-2">&amp;</span><span class="ident">tmp_dir</span>.<span class="ident">path</span>(), <span class="kw-2">&amp;</span><span class="ident">bin_name</span>)<span class="question-mark">?</span>;

    <span class="kw">let</span> <span class="ident">tmp_file</span> <span class="op">=</span> <span class="ident">tmp_dir</span>.<span class="ident">path</span>().<span class="ident">join</span>(<span class="string">&quot;replacement_tmp&quot;</span>);
    <span class="kw">let</span> <span class="ident">bin_path</span> <span class="op">=</span> <span class="ident">tmp_dir</span>.<span class="ident">path</span>().<span class="ident">join</span>(<span class="ident">bin_name</span>);
    <span class="ident">self_update::Move::from_source</span>(<span class="kw-2">&amp;</span><span class="ident">bin_path</span>)
        .<span class="ident">replace_using_temp</span>(<span class="kw-2">&amp;</span><span class="ident">tmp_file</span>)
        .<span class="ident">to_dest</span>(<span class="kw-2">&amp;</span><span class="ident">::std::env::current_exe</span>()<span class="question-mark">?</span>)<span class="question-mark">?</span>;

    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="backends/index.html" title="self_update::backends mod">backends</a></div><div class="item-right docblock-short"><p>Collection of modules supporting various release distribution backends</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="errors/index.html" title="self_update::errors mod">errors</a></div><div class="item-right docblock-short"><p>Error type, conversions, and macros</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="update/index.html" title="self_update::update mod">update</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="version/index.html" title="self_update::version mod">version</a></div><div class="item-right docblock-short"><p>Semver version checks</p>
</div></div></div><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.cargo_crate_version.html" title="self_update::cargo_crate_version macro">cargo_crate_version</a></div><div class="item-right docblock-short"><p>Allows you to pull the version from your Cargo.toml at compile time as
<code>MAJOR.MINOR.PATCH_PKGVERSION_PRE</code></p>
</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Download.html" title="self_update::Download struct">Download</a></div><div class="item-right docblock-short"><p>Download things into files</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Extract.html" title="self_update::Extract struct">Extract</a></div><div class="item-right docblock-short"><p>Extract contents of an encoded archive (e.g. tar.gz) file to a specified directory</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Move.html" title="self_update::Move struct">Move</a></div><div class="item-right docblock-short"><p>Moves a file from the given path to the specified destination.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TempDir.html" title="self_update::TempDir struct">TempDir</a></div><div class="item-right docblock-short"><p>A directory in the filesystem that is automatically deleted when
it goes out of scope.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ArchiveKind.html" title="self_update::ArchiveKind enum">ArchiveKind</a></div><div class="item-right docblock-short"><p>Supported archive formats</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Compression.html" title="self_update::Compression enum">Compression</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Status.html" title="self_update::Status enum">Status</a></div><div class="item-right docblock-short"><p>Status returned after updating</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.get_target.html" title="self_update::get_target fn">get_target</a></div><div class="item-right docblock-short"><p>Get the current target triple.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.should_update.html" title="self_update::should_update fn">should_update</a><span class="stab deprecated" title="">Deprecated</span></div><div class="item-right docblock-short"><p>Check if a version tag is greater than the current</p>
</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.GetArchiveReaderResult.html" title="self_update::GetArchiveReaderResult type">GetArchiveReaderResult</a></div><div class="item-right docblock-short"></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="self_update" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0 (4b91a6ea7 2022-08-08)" ></div>
</body></html>